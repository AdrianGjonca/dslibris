#!/usr/bin/env bash
# Attempts to set up a machine that has never seen anything devkitPro-related before.
# Take it with a salt-grain; read it and do it yourself step by step.

arch=$(uname -m)
system=$(uname -s)
case $system in
	Darwin)
	ext=pkg
	;;
	Linux)
	ext=deb
	;;
	*)
	echo fatal: system $system unknown.	
	exit 1
	;;
esac
case $arch in
	aarch64)
	arch=arm64
	;;
	x86_64)
	arch=amd64
	;;
	*)
	echo fatal: arch $arch unknown.
	exit 1
	;;
esac

pacball=devkitpro-pacman.$arch.$ext
wget https://github.com/devkitPro/pacman/releases/download/v1.0.2/$pacball

if [ $system = Linux ]
then
	sudo apt install wget gdebi-core -y
	sudo gdebi -n devkitpro-pacman.$arch.deb
fi

sudo dkp-pacman -S --noconfirm dkp-toolchain-vars default-arm7 devkitARM devkitarm-crtls devkitarm-rules devkitpro-keyring dstools grit libfat-nds libnds nds-bzip2 nds-freetype nds-libexpat nds-libpng nds-pkg-config nds-zlib ndstool 

rm $pacball

